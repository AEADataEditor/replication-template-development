name: Deploy template repo
on: 
  workflow_dispatch:
  push:
    branches: 
      - development
jobs:
  deploy:
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.message, '[skipci]')"
    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v1 # If you're using actions/checkout@v2 you must set persist-credentials to false in most cases for the deployment to work correctly.         
      - name: clean out
        run: |
          rm -rf .git    
      # send it to gh-pages
      # We use a personal token to allow for posting despite branch controls - see https://github.com/peaceiris/actions-gh-pages for parameters
      # We also use a *beta* feature to post to a particular destination_dir. 
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3.8.0
        with:
          deploy_key: ${{ secrets.PUSH_DEPLOY_KEY }}
          user_name: 'Github Action Bot'
          user_email: 'lars.vilhuber@cornell.edu'
          external_repository: aeadataeditor/replication-template
          publish_branch: master
          publish_dir: ./
          keep_files: false
          force_orphan: true
          exclude_assets: '.github'
          commit_message: ${{ github.event.head_commit.message }}
